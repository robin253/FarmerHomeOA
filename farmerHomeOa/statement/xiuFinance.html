<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>修改财务报表管理</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="../common/layui/css/layui.css" />
		<link rel="stylesheet" href="../common/css/bootstrap.min.css" />
		<style>
			*{ margin:0; padding:0; list-style:none;}
			a{ text-decoration:none;}
			a:hover{ text-decoration:none;}
			.tcdPageCode{padding: 15px 20px;text-align: left;color: #ccc;text-align:center;}
			.tcdPageCode a{display: inline-block;color: #428bca;display: inline-block;height: 25px;	line-height: 25px;	padding: 0 10px;border: 1px solid #ddd;	margin: 0 2px;border-radius: 4px;vertical-align: middle;}
			.tcdPageCode a:hover{text-decoration: none;border: 1px solid #428bca;}
			.tcdPageCode span.current{display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;color: #fff;background-color: #428bca;	border: 1px solid #428bca;border-radius: 4px;vertical-align: middle;}
			.tcdPageCode span.disabled{	display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;	color: #bfbfbf;background: #f2f2f2;border: 1px solid #bfbfbf;border-radius: 4px;vertical-align: middle;}
		    .txts{
		    	display: inline-block;
            	width:100px;
            	overflow: hidden;
            	white-space: nowrap;
            	text-overflow: ellipsis;
		    }
		    .txt{
		    	width:50px;
		    } 
		</style>
	</head>
	<body>
		<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			<legend>修改财务报表管理</legend>
		</fieldset>
		<form id="search" class="form-inline clearfix">
			<div class="searchItems">
				<div class="form-group">
					<button class="layui-btn layui-btn-normal header-dropdown-menu fan">返回</button>
					<button class="layui-btn  header-dropdown-menu bao">保存</button>
				</div>
				<div class="form-group" style="float:right;margin-right:30px;">
					<button type="button" class="btn btn-info shua"> 页面刷新</button>
				</div>
			</div>
		</form>
		<div style="width:98%;overflow-x: scroll;">
			<table id="biuuu_city_list" class="layui-table">
			<thead>
				<tr>
					<th>标题</th>
					<th colspan="22" style="text-align: center;"><input type="text" value=""   class="form-control checkLogs title txt" style="width:50%;margin: auto;" autocomplete="off"></th>
				</tr>
				<tr>
					<th style="text-align: center;">资产</th>
					<th colspan="10" style="text-align: center;">流动资产</th>
					<th colspan="3" style="text-align: center;">长期投资</th>
					<th colspan="6" style="text-align: center;">固定资产</th>
					<th style="text-align: center;">无形资产</th>
					<th style="text-align: center;">受托代理资产</th>
					<th style="text-align: center;">资产总计</th>
				</tr>
			</thead>
			<tbody style="text-align: center;">
             <tr>
             	<td></td>
             	<td>货币资金</td><td>短期投资</td><td>应收款项</td><td>预付账款</td><td>存货</td><td>待摊费用</td><td>一年内到期的长期债权投资</td><td>其他流动资产</td><td>流动资产合计</td>
                <td>长期股权投资</td><td>长期债权投资</td><td>长期投资合计</td>
                <td>固定资产原价</td><td>减：累积折旧</td><td>固定资产净值</td><td>在建工程</td><td>文物文化资产</td><td>固定资产清理</td><td>固定资产合计</td>
                <td>无形资产</td>
                <td>受托代理资产</td>
                <td>资产总计</td>
             </tr>
             <tr class="tt1">
             	
             </tr>
              <tr class="tt2">
             	
             </tr>
             <tr>
				<th style="text-align: center;"><span class="txts">负债和净资产</span></th>
				<th colspan="10" style="text-align: center;">流动负债</th>
				<th colspan="4" style="text-align: center;">长期负债</th>
				<th colspan="2" style="text-align: center;">受托代理负债</th>
				<th colspan="3" style="text-align: center;">净资产</th>
				<th title="负债和净资产合计" style="text-align: center;"><span class="txts">负债和净资产合计</span></th>
				<th style="text-align: center;">待续...</th>
				<th style="text-align: center;"></th>
			</tr>
			 <tr>
             	<td></td>
             	<td>短期借款</td><td>应付款项</td><td>应付工资</td><td>应交税金</td><td>预收账款</td><td>预提费用</td><td>预计负债</td><td>一年内到期的长期负债</td><td>其他流动负债</td><td>流动负债合计</td>
                <td>长期借款</td><td>长期应付款</td><td>其他长期负债</td><td>长期负债合计</td>
                <td>受托代理负债</td><td>负债合计</td>
                <td>非限定性净资产</td><td>限定性净资产</td><td>净资产合计</td>
                <td>负债和净资产合计</td>
                <td></td><td></td>
             </tr>
             <tr class="t1">
             	
             </tr>
             <tr class="t2">
             	
             </tr>
			</tbody>
		</table>
		</div>
		
		<div class="tcdPageCode"></div>
		<div id="demo8" style="text-align: center;"></div>
		<script src="../common/js/jquery-1.12.3.min.js"></script>
		<script type="text/javascript" src="../common/layui/layui.js"></script>
		<script src="../common/layui/lay/modules/laydate.js"></script>
		<script src='../common/layui/lay/modules/laypage.js'></script>
		<script src="../common/js/bootstrap.min.js"></script>
		<script src="../common/js/jquery.bootstrap.min.js"></script>
		<script src="../common/js/search-logs.js"></script>
		<script src="../common/js/jquery.page.js"></script>
		<script src="../common/js/md5.js"></script>
		<script>
		var sessionId=sessionStorage.session_id;
		(function ($) {
            $.getUrlParam = function (name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                var r = window.location.search.substr(1).match(reg);
                if (r != null) return unescape(r[2]); return null;
            }
        })(jQuery);
        var id = $.getUrlParam('id');
        var page=$.getUrlParam('page');
        //获取信息
        $.ajax({
        	type:"post",
        	url:href+"/api/back/reportFinance/detail",
        	data:{
        		reportId:id,
        		sessionId:sessionId
        	},
        	dataType:"json",
        	success:function(data){
        		var d=data.data;
        		$(".title").val(d.title);
        		$(".txt").eq(1).val(d.hbzj_begin);
        		$(".txt").eq(2).val(d.dqtz_begin);
        		$(".txt").eq(3).val(d.yskx_begin);
        		$(".txt").eq(4).val(d.yfzk_begin);
        		$(".txt").eq(5).val(d.ch_begin);
        		$(".txt").eq(6).val(d.dtfy_begin);
        		$(".txt").eq(7).val(d.ynndqdcqzqtz_begin);
        		$(".txt").eq(8).val(d.qtldzc_begin);
        		$(".txt").eq(9).val(d.ldzchj_begin);
        		$(".txt").eq(10).val(d.cqgqtz_begin);
        		$(".txt").eq(11).val(d.cqzqtz_begin);
        		$(".txt").eq(12).val(d.cqtzhj_begin);
        		$(".txt").eq(13).val(d.gdzcyj_begin);
        		$(".txt").eq(14).val(d.ljzj_begin);
        		$(".txt").eq(15).val(d.gdzcjz_begin);
        		$(".txt").eq(16).val(d.zjgc_begin);
        		$(".txt").eq(17).val(d.wwwhzc_begin);
        		$(".txt").eq(18).val(d.gdzcql_begin);
        		$(".txt").eq(19).val(d.gdzchj_begin);
        		$(".txt").eq(20).val(d.wxzc_begin);
        		$(".txt").eq(21).val(d.stdlzc_begin);
        		$(".txt").eq(22).val(d.zczj_begin);
        		$(".txt").eq(23).val(d.hbzj_end);
        		$(".txt").eq(24).val(d.dqtz_end);
        		$(".txt").eq(25).val(d.yskx_end);
        		$(".txt").eq(26).val(d.yfzk_end);
        		$(".txt").eq(27).val(d.ch_end);
        		$(".txt").eq(28).val(d.dtfy_end);
        		$(".txt").eq(29).val(d.ynndqdcqzqtz_end);
        		$(".txt").eq(30).val(d.qtldzc_end);
        		$(".txt").eq(31).val(d.ldzchj_end);
        		$(".txt").eq(32).val(d.cqgqtz_end);
        		$(".txt").eq(33).val(d.cqzqtz_end);
        		$(".txt").eq(34).val(d.cqtzhj_end);
        		$(".txt").eq(35).val(d.gdzcyj_end);
        		$(".txt").eq(36).val(d.ljzj_end);
        		$(".txt").eq(37).val(d.gdzcjz_end);
        		$(".txt").eq(38).val(d.zjgc_end);
        		$(".txt").eq(39).val(d.wwwhzc_end);
        		$(".txt").eq(40).val(d.gdzcql_end);
        		$(".txt").eq(41).val(d.gdzchj_end);
        		$(".txt").eq(42).val(d.wxzc_end);
        		$(".txt").eq(43).val(d.stdlzc_end);
        		$(".txt").eq(44).val(d.zczj_end);
        		$(".txt").eq(45).val(d.dqjd_begin);
        		$(".txt").eq(46).val(d.yfkx_begin);
        		$(".txt").eq(47).val(d.yfgz_begin);
        		$(".txt").eq(48).val(d.yjsj_begin);
        		$(".txt").eq(49).val(d.yszk_begin);
        		$(".txt").eq(50).val(d.ytfy_begin);
        		$(".txt").eq(51).val(d.yjfz_begin);
        		$(".txt").eq(52).val(d.ynndqdcqfz_begin);
        		$(".txt").eq(53).val(d.qtldfz_begin);
        		$(".txt").eq(54).val(d.ldfzhj_begin);
        		$(".txt").eq(55).val(d.cqjd_begin);
        		$(".txt").eq(56).val(d.cqyfk_begin);
        		$(".txt").eq(57).val(d.qtcqfz_begin);
        		$(".txt").eq(58).val(d.cqfzhj_begin);
        		$(".txt").eq(59).val(d.stdlfz_begin);
        		$(".txt").eq(60).val(d.fzhj_begin);
        		$(".txt").eq(61).val(d.fxdxjzc_begin);
        		$(".txt").eq(62).val(d.xdxjzc_begin);
        		$(".txt").eq(63).val(d.jzchj_begin);
        		$(".txt").eq(64).val(d.fzhjzchj_begin);
        		$(".txt").eq(65).val(d.dqjd_end);
        		$(".txt").eq(66).val(d.yfkx_end);
        		$(".txt").eq(67).val(d.yfgz_end);
        		$(".txt").eq(68).val(d.yjsj_end);
        		$(".txt").eq(69).val(d.yszk_end);
        		$(".txt").eq(70).val(d.ytfy_end);
        		$(".txt").eq(71).val(d.yjfz_end);
        		$(".txt").eq(72).val(d.ynndqdcqfz_end);
        		$(".txt").eq(73).val(d.qtldfz_end);
        		$(".txt").eq(74).val(d.ldfzhj_end);
        		$(".txt").eq(75).val(d.cqjd_end);
        		$(".txt").eq(76).val(d.cqyfk_end);
        		$(".txt").eq(77).val(d.qtcqfz_end);
        		$(".txt").eq(78).val(d.cqfzhj_end);
        		$(".txt").eq(79).val(d.stdlfz_end);
        		$(".txt").eq(80).val(d.fzhj_end);
        		$(".txt").eq(81).val(d.fxdxjzc_end);
        		$(".txt").eq(82).val(d.xdxjzc_end);
        		$(".txt").eq(83).val(d.jzchj_end);
        		$(".txt").eq(84).val(d.fzhjzchj_end);
        	}
        })
		//刷新页面
			$(".shua").on('click',function(event){
				event.preventDefault();
				window.location.href="xiuFinance.html?id="+id+"&page="+page;
			})
		//返回
		$(".fan").on("click",function(event){
			event.preventDefault();
			window.location.href="statementManage.html?xx="+page;
		});
		//只能输入两位小数:
		  function clearNoNum(obj) {
		        obj.value = obj.value.replace(/[^\d.]/g, "");  //清除“数字”和“.”以外的字符
		        obj.value = obj.value.replace(/\.{2,}/g, "."); //只保留第一个. 清除多余的
		        obj.value = obj.value.replace(".", "$#$").replace(/\./g, "").replace("$#$", ".");
		        obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d).*$/, '$1$2.$3');//只能输入两个小数
		        if (obj.value.indexOf(".") < 0 && obj.value != "") {//以上已经过滤，此处控制的是如果没有小数点，首位不能为类似于 01、02的金额
		            obj.value = parseFloat(obj.value);
		        }
		        ;
		
		   };
		   //获取第一个年初数
		   var otr0="<td>年初数</td>";
		  for(var i=0;i<22;i++){
		  	otr0 += '<td><input type="text" value="'+(i+1)+'" onkeyup="clearNoNum(this)"  class="form-control checkLogs txt" autocomplete="off"></td>'
		  };
		  $(".tt1").html(otr0);
		  //获取第一个期末数
		   var otr3="<td>期末数</td>";
		  for(var i=0;i<22;i++){
		  	otr3 += '<td><input type="text" value="'+(23+i)+'" onkeyup="clearNoNum(this)"  class="form-control checkLogs txt" autocomplete="off"></td>'
		  };
		  $(".tt2").html(otr3);
		  //获取年初数
		  var otr1="<td>年初数</td>";
		  for(var i=0;i<20;i++){
		  	otr1 += '<td><input type="text" value="'+(45+i)+'" onkeyup="clearNoNum(this)"  class="form-control checkLogs txt" autocomplete="off"></td>'
		  };
		  $(".t1").html(otr1+'<td></td><td></td>');
		  //获取期末数
		  var otr2="<td>期末数</td>";
		  for(var i=0;i<20;i++){
		  	otr2 += '<td><input type="text" value="'+(65+i)+'" onkeyup="clearNoNum(this)"  class="form-control checkLogs txt" autocomplete="off"></td>'
		  };
		  $(".t2").html(otr2+'<td></td><td></td>'); 
		  //保存
		  $(".bao").on("click",function(event){
		  	event.preventDefault();
		  	if($(".title").val()==""){
		  		alert("请填写标题");
		  		return;
		  	}
		  	var s="";
		  	for(var i=0;i<$(".txt").length;i++){
		  		if($(".txt").eq(i).val()==""){
		  			alert("表格里面的数据不能为空");
		  			return;
		  		}
		  	};
		  	s=$(".txt").eq(0).val();
		  	for(var i=1;i<$(".txt").length;i++){
		  	 s += ","+ $(".txt").eq(i).val();	
		  	};
		  	$.ajax({
		  		type:"post",
		  		url:href+"/api/back/reportFinance/save",
		  		data:{
		  			id:id,
		  			title:$(".title").val(),
		  			chBegin:$(".txt").eq(5).val(),
		  			chEnd:$(".txt").eq(27).val(),
		  			cqfzhjBegin:$(".txt").eq(58).val(),
		  			cqfzhjEnd:$(".txt").eq(78).val(),
		  			cqgqtzBegin:$(".txt").eq(10).val(),
		  			cqgqtzEnd:$(".txt").eq(32).val(),
		  			cqjdBegin:$(".txt").eq(55).val(),
		  			cqjdEnd:$(".txt").eq(75).val(),
		  			cqtzhjBegin:$(".txt").eq(12).val(),
		  			cqtzhjEnd:$(".txt").eq(34).val(),
		  			cqyfkBegin:$(".txt").eq(56).val(),
		  			cqyfkEnd:$(".txt").eq(76).val(),
		  			cqzqtzBegin:$(".txt").eq(11).val(),
		  			cqzqtzEnd:$(".txt").eq(33).val(),
		  			dqjdBegin:$(".txt").eq(45).val(),
		  			dqjdEnd:$(".txt").eq(65).val(),
		  			dqtzBegin:$(".txt").eq(2).val(),
		  			dqtzEnd:$(".txt").eq(24).val(),
		  			dtfyBegin:$(".txt").eq(6).val(),
		  			dtfyEnd:$(".txt").eq(28).val(),
		  			fxdxjzcBegin:$(".txt").eq(61).val(),
		  			fxdxjzcEnd:$(".txt").eq(81).val(),
		  			fzhjBegin:$(".txt").eq(60).val(),
		  			fzhjEnd:$(".txt").eq(80).val(),
		  			fzhjzchjBegin:$(".txt").eq(64).val(),
		  			fzhjzchjEnd:$(".txt").eq(84).val(),
		  			gdzchjBegin:$(".txt").eq(19).val(),
		  			gdzchjEnd:$(".txt").eq(41).val(),
		  			gdzcjzBegin:$(".txt").eq(15).val(),
		  			gdzcjzEnd:$(".txt").eq(37).val(),
		  			gdzcqlBegin:$(".txt").eq(18).val(),
		  			gdzcqlEnd:$(".txt").eq(40).val(),
		  			gdzcyjBegin:$(".txt").eq(13).val(),
		  			gdzcyjEnd:$(".txt").eq(35).val(),
		  			hbzjBegin:$(".txt").eq(1).val(),
		  			hbzjEnd:$(".txt").eq(23).val(),
		  			jzchjBegin:$(".txt").eq(63).val(),
		  			jzchjEnd:$(".txt").eq(83).val(),
		  			ldfzhjBegin:$(".txt").eq(54).val(),
		  			ldfzhjEnd:$(".txt").eq(74).val(),
		  			ldzchjBegin:$(".txt").eq(9).val(),
		  			ldzchjEnd:$(".txt").eq(31).val(),
		  			ljzjBegin:$(".txt").eq(14).val(),
		  			ljzjEnd:$(".txt").eq(36).val(),
		  			qtldfzBegin:$(".txt").eq(57).val(),
		  			qtldfzEnd:$(".txt").eq(77).val(),
		  			qtcqfzBegin:$(".txt").eq(53).val(),
		  			qtcqfzEnd:$(".txt").eq(73).val(),
		  			qtldzcBegin:$(".txt").eq(8).val(),
		  			qtldzcEnd:$(".txt").eq(30).val(),
		  			stdlfzBegin:$(".txt").eq(59).val(),
		  			stdlfzEnd:$(".txt").eq(79).val(),
		  			stdlzcBegin:$(".txt").eq(21).val(),
		  			stdlzcEnd:$(".txt").eq(43).val(),
		  			wwwhzcBegin:$(".txt").eq(17).val(),
		  			wwwhzcEnd:$(".txt").eq(39).val(),
		  			wxzcBegin:$(".txt").eq(20).val(),
		  			wxzcEnd:$(".txt").eq(42).val(),
		  			xdxjzcBegin:$(".txt").eq(62).val(),
		  			xdxjzcEnd:$(".txt").eq(82).val(),
		  			yfkxBegin:$(".txt").eq(46).val(),
		  			yfkxEnd:$(".txt").eq(66).val(),
		  			yfzkBegin:$(".txt").eq(4).val(),
		  			yfzkEnd:$(".txt").eq(26).val(),
		  			yjfzBegin:$(".txt").eq(51).val(),
		  			yjfzEnd:$(".txt").eq(71).val(),
		  			yjsjBegin:$(".txt").eq(48).val(),
		  			yjsjEnd:$(".txt").eq(68).val(),
		  			ynndqdcqfzBegin:$(".txt").eq(52).val(),
		  			ynndqdcqfzEnd:$(".txt").eq(72).val(),
		  			ynndqdcqzqtzBegin:$(".txt").eq(7).val(),
		  			ynndqdcqzqtzEnd:$(".txt").eq(29).val(),
		  			yskxBegin:$(".txt").eq(3).val(),
		  			yskxEnd:$(".txt").eq(25).val(),
		  			yszkBegin:$(".txt").eq(49).val(),
		  			yszkEnd:$(".txt").eq(69).val(),
		  			ytfyBegin:$(".txt").eq(50).val(),
		  			ytfyEnd:$(".txt").eq(70).val(),
		  			zczjBegin:$(".txt").eq(22).val(),
		  			zczjEnd:$(".txt").eq(44).val(),
		  			zjgcBegin:$(".txt").eq(16).val(),
		  			zjgcEnd:$(".txt").eq(38).val(),
		  			reportType:1,
		  			sessionId:sessionId
		  		},
		  		dataType:"json",
		  		success:function(data){
		  			if(data.resultCode==1){
					alert(data.resultMsg);
					return;
					}else{
						window.location.reload()
					}
		  		}
		  	});
		  });
		</script>
	</body>
</html>